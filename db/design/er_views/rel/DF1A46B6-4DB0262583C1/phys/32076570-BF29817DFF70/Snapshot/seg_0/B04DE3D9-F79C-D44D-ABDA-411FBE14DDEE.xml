<?xml version = '1.0' encoding = 'UTF-8'?>
<SnapshotOraclev11g class="oracle.dbtools.crest.model.design.storage.oracle.v11g.SnapshotOraclev11g" name="BIOQC_RES_CONTAM" directorySegmentName="seg_0" id="B04DE3D9-F79C-D44D-ABDA-411FBE14DDEE">
<sourceConnName>bin_srslight</sourceConnName>
<sourceObjSchema>SRSLIGHT</sourceObjSchema>
<sourceObjName>BIOQC_RES_CONTAM</sourceObjName>
<createdBy>sturmg</createdBy>
<createdTime>2016-12-15 08:33:26 UTC</createdTime>
<ownerDesignName>er_views</ownerDesignName>
<schemaObject>467C9D78-14EE-283D-5271-3C94AD8626A0</schemaObject>
<action>ON DEMAND</action>
<defaultSegment>NO</defaultSegment>
<degree>16</degree>
<parallelClause>YES</parallelClause>
<refresh>YES</refresh>
<refreshType>FORCE</refreshType>
<subquery>with &lt;br/&gt;  expected_signatures as (&lt;br/&gt;    select  bts.* &lt;br/&gt;          , bs.name as signature_name&lt;br/&gt;    from bioqc_tissue_set bts&lt;br/&gt;    join bioqc_signatures bs on bs.id = bts.signature&lt;br/&gt;  ), &lt;br/&gt;  bioqc_res_fil_tset as (&lt;br/&gt;    select  brf.gsm&lt;br/&gt;          , brf.tissue&lt;br/&gt;          , bts.tgroup&lt;br/&gt;          , bts.tissue_set &lt;br/&gt;          , brf.signature&lt;br/&gt;          , brf.signature_name&lt;br/&gt;          , brf.pvalue&lt;br/&gt;    from bioqc_res_fil brf&lt;br/&gt;    join bioqc_tissue_set bts &lt;br/&gt;      on bts.tissue = brf.tissue&lt;br/&gt;    -- make sure only the signature from the same signature set are included. &lt;br/&gt;    where brf.signature in (&lt;br/&gt;      select bts2.signature&lt;br/&gt;      from bioqc_tissue_set bts2&lt;br/&gt;      where bts2.tissue_set = bts.tissue_set&lt;br/&gt;    )&lt;br/&gt;  )&lt;br/&gt;  select /*+ PARALLEL(16) */  distinct -- distinct, because tissue -&gt; tissue_group -&gt; tissue is not unique. &lt;br/&gt;                              brf.gsm&lt;br/&gt;                            , brf.tissue&lt;br/&gt;                            , brf.tgroup&lt;br/&gt;                            , brf.tissue_set&lt;br/&gt;                            , brf.signature&lt;br/&gt;                            , brf.signature_name&lt;br/&gt;                            , brf.pvalue                            &lt;br/&gt;                            , es.signature as exp_sig&lt;br/&gt;                            , es.signature_name as exp_sig_name&lt;br/&gt;                            , brf2.pvalue as exp_sig_pvalue&lt;br/&gt;                            , log(10, cast(brf2.pvalue / brf.pvalue as binary_float)) as enrichment_ratio &lt;br/&gt;  from bioqc_res_fil_tset brf&lt;br/&gt;  &lt;br/&gt;  -- get all signatures related to tissue groups (&quot;expected signatures&quot;)&lt;br/&gt;  join expected_signatures es &lt;br/&gt;    on es.tgroup = brf.tgroup&lt;br/&gt;    and es.tissue_set = brf.tissue_set&lt;br/&gt;  &lt;br/&gt;  -- get pvalues of expected signatures. Match them to the respective sample.  &lt;br/&gt;  join bioqc_res_fil_tset brf2 &lt;br/&gt;    on brf2.gsm = brf.gsm &lt;br/&gt;    and brf2.signature = es.signature &lt;br/&gt;    &lt;br/&gt;  -- exclude expected signatures (e.g. jejunum having a high enrichment ratio&lt;br/&gt;  -- in relation to colon)&lt;br/&gt;  where brf.signature not in (&lt;br/&gt;    select signature&lt;br/&gt;    from expected_signatures es2&lt;br/&gt;    where es2.tgroup = brf.tgroup&lt;br/&gt;    and es2.tissue_set = brf.tissue_set&lt;br/&gt;  )&lt;br/&gt;  &lt;br/&gt;--  where 1 = 1&lt;br/&gt;  </subquery>
<subqueryChanged>false</subqueryChanged>
<subqueryNeedsMigration>false</subqueryNeedsMigration>
<tablespace>023AB8E3-EFF6-7C70-B387-18886D1ADF86</tablespace>
<useIndex>YES</useIndex>
<with></with>
</SnapshotOraclev11g>